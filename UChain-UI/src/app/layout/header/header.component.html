<nav #navbar class="navbar active">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="#" onClick="return false;" class="navbar-toggle collapsed"
        (click)="isNavbarCollapsed = !isNavbarCollapsed" aria-expanded="false"></a>
      <a href="#" onClick="return false;" class="bars" (click)="mobileMenuSidebarOpen($event,'overlay-open')"></a>
      <a class="navbar-brand" routerLink={{homePage}}>
        <img src="assets/images/logo.png" alt=""  width="30px" height="30px"/>
        <span class="logo-name" style="color: rgb(51, 159, 51);">U-Chain</span>
      </a>
    </div>
    <div class="collapse navbar-collapse" [class.collapse]="isNavbarCollapsed">
      <ul class="pull-left collapse-menu-icon">
        <li>
          <button mat-icon-button (click)="callSidemenuCollapse()" class="sidemenu-collapse">
            <mat-icon>menu</mat-icon>
          </button>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <!-- Full Screen Button -->
        <li class="fullscreen">
          <button mat-icon-button (click)="callFullscreen()" class=" nav-notification-icons">
            <mat-icon>fullscreen</mat-icon>
          </button>
        </li>
        <!-- #END# Full Screen Button -->
        <!-- #START# Notifications-->
        <li class="nav-item">
          <button mat-icon-button class="nav-notification-icons" (click)="toggleNotifications(); $event.stopPropagation()">
            <mat-icon [ngClass]="{'text-warning': unreadCount > 0}">{{ unreadCount > 0 ? 'notifications_active' : 'notifications_none' }}</mat-icon>
            <span class="label-count bg-danger" *ngIf="unreadCount > 0">{{unreadCount}}</span>
          </button>
          <div *ngIf="showNotifications" class="notification-dropdown pullDown" (click)="$event.stopPropagation()">
            <div class="notification-header d-flex justify-content-between p-3">
              <span class="font-weight-bold">Notifications</span>
              <a *ngIf="notifications.length > 0" (click)="markAllAsRead()" class="text-primary cursor-pointer">
                Mark All Read
              </a>
            </div>
            <div class="noti-list" style="position: relative; max-width: 800px; max-height: 250px; overflow: auto;">
              <ul class="menu">
                <li *ngIf="notifications.length === 0" class="text-center py-3">No notifications</li>
                <li *ngFor="let notification of notifications">
                  <div class="notification-item" [ngClass]="{'unread': !notification.is_read}">
                    <div class="d-flex p-2">
                      <div class="mr-3 notification-icon" [ngClass]="'bg-' + (notification.notification_type | lowercase)">
                        <mat-icon>{{getNotificationIcon(notification.notification_type)}}</mat-icon>
                      </div>
                      <div class="notification-content flex-grow-1">
                        <div class="d-flex align-items-center justify-content-between">
                          <div class="notification-message">{{notification.message}}</div>
                          <div class="notification-actions ml-3" *ngIf="!notification.is_read">
                            <button mat-icon-button (click)="markAsRead(notification.id); $event.stopPropagation()" title="Mark as read" class="small-button">
                              <mat-icon class="text-primary">done</mat-icon>
                            </button>
                          </div>
                        </div>
                        <div class="notification-time">
                          <i class="material-icons">access_time</i>
                          {{notification.created_at | date:'medium'}}
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </li>
        <!-- #END# Notifications-->
        <li class="nav-item user_profile">
          <a href="#" onClick="return false;" role="button" class="nav-notification-icons pt-0"
             (click)="toggleUserMenu(); $event.preventDefault(); $event.stopPropagation()">
            <b>{{username}}</b>
          </a>
          <div *ngIf="showUserMenu" class="notification-dropdown pullDown" (click)="$event.stopPropagation()">
            <div class="noti-list" style="position: relative; max-width: 600px; max-height: 300px; overflow: auto;">
              <ul class="menu">
                <li class="body">
                  <ul class="user_dw_menu">
                    <li>
                      <a href="#" onClick="return false;">
                        <mat-icon aria-hidden="false" class="mr-2">person</mat-icon>Profile
                      </a>
                    </li>
                    <li>
                      <a href="#" onClick="return false;">
                        <mat-icon aria-hidden="false" class="mr-2">feedback</mat-icon>Feedback
                      </a>
                    </li>
                    <li>
                      <a href="#" onClick="return false;">
                        <mat-icon aria-hidden="false" class="mr-2">help</mat-icon>Help
                      </a>
                    </li>
                    <li>
                      <a href="javascript:void(0);" (click)="logout()">
                        <mat-icon aria-hidden="false" class="mr-2">power_settings_new</mat-icon>Logout
                      </a>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </li>
        <!-- #END# Tasks -->
        <li class="pull-right">
          <button mat-icon-button (click)="toggleRightSidebar()" class="nav-notification-icons js-right-sidebar">
            <mat-icon id="settingBtn">settings</mat-icon>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>
